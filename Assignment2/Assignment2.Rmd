---
title: "STA355H1 - Assignment 2"
output: html_document
---

```{r}
n <- 60
m <- matrix(rlogis(10000*n, location = 0, scale = 1), ncol = n)
# Sort each sample
m <- t(apply(m, 1, sort))
# Compute the confidence interval
theta_hat <- (m[, 30] + m[, 31]) / 2
W <- rexp(10000, rate = 1/2)
var_hat_theta_hat <- W*4/n
lower <- theta_hat - 1.645*sqrt(var_hat_theta_hat)
upper <- theta_hat + 1.645*sqrt(var_hat_theta_hat)
contains_zero <- (lower <= 0) & (upper >= 0)
sum(contains_zero) / length(contains_zero)
```

```{r}
# Load necessary libraries
library(ggplot2)
library(gridExtra)

# Set parameters
num_samples <- 1000
sample_size <- 500

# Generate 1000 samples from a standard normal distribution
samples <- replicate(num_samples, rnorm(sample_size))

# Create a list to store Q-Q plots
qq_plots <- list()

# Generate Q-Q plots for each sample
for (i in 1:num_samples) {
  qq_plot <- ggplot(data.frame(sample = samples[, i]), aes(sample = sample)) +
    stat_qq() +
    stat_qq_line() +
    ggtitle(paste("Sample", i)) +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5))
  qq_plots[[i]] <- qq_plot
}

# Combine all Q-Q plots into one graphic
grid.arrange(grobs = qq_plots, ncol = 5)
```

```{r}
# Load necessary libraries
library(ggplot2)
library(gridExtra)

# Set parameters
num_samples <- 1000
sample_size <- 500

# Generate 1000 samples from a logistic distribution
samples <- replicate(num_samples, rlogis(sample_size, location = 0, scale = 1))

# Create a list to store Q-Q plots
qq_plots <- list()

# Generate Q-Q plots for each sample
for (i in 1:num_samples) {
  qq_plot <- ggplot(data.frame(sample = samples[, i]), aes(sample = sample)) +
    stat_qq(distribution = qlogis, dparams = list(location = 0, scale = 1)) +
    stat_qq_line(distribution = qlogis, dparams = list(location = 0, scale = 1)) +
    ggtitle(paste("Sample", i)) +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5))
  qq_plots[[i]] <- qq_plot
}

# Combine all Q-Q plots into one graphic
grid.arrange(grobs = qq_plots, ncol = 5)
```
