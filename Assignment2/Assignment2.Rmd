---
title: "STA355H1 - Assignment 2"
output: html_document
---

```{r}
n <- 60
m <- matrix(rlogis(10000*n, location = 0, scale = 1), ncol = n)
# Sort each sample
m <- t(apply(m, 1, sort))
# Compute the confidence interval
theta_hat <- (m[, 30] + m[, 31]) / 2
W <- rexp(10000, rate = 1/2)
var_hat_theta_hat <- W*4/n
lower <- theta_hat - 1.645*sqrt(var_hat_theta_hat)
upper <- theta_hat + 1.645*sqrt(var_hat_theta_hat)
contains_zero <- (lower <= 0) & (upper >= 0)
sum(contains_zero) / length(contains_zero)
```

```{r}
n <- 500
samples <- matrix(rnorm(1000*n), ncol = n)
x_k <- t(apply(samples, 1, sort)) # Ordered values
tau_k <- (1:n - 0.5)/n
F_inv <- qnorm(tau_k) # Theoretical quantiles
plot(rep(F_inv, 1000), c(t(x_k)), xlab = "Theoretical quantiles", ylab = "Sample quantiles") # Superimposed plot
abline(0, 1, lwd = 3, col = "red")
```

```{r}
n <- 500
samples <- matrix(rlogis(1000*n), ncol = n)
x_k <- t(apply(samples, 1, sort)) # Ordered values
tau_k <- (1:n - 0.5)/n
F_inv <- qlogis(tau_k) # Theoretical quantiles
plot(rep(F_inv, 1000), c(t(x_k)), xlab = "Theoretical quantiles", ylab = "Sample quantiles") # Superimposed plot
abline(0, 1, lwd = 3, col = "red")
```
